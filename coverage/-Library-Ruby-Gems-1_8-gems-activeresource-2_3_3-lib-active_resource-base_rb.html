<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='en' xml:lang='en' xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>/Library/Ruby/Gems/1.8/gems/activeresource-2.3.3/lib/active_resource/base.rb</title>
    <link href="screen.css" media="all" rel="stylesheet" type="text/css" />
    <link href="print.css" media="print" rel="stylesheet" type="text/css" />
    
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <script type="text/javascript" src="rcov.js"></script>
  </head>
  <body>
    <h1>Rails Rrdtool C0 Coverage Information - RCov</h1>
    <h2>/Library/Ruby/Gems/1.8/gems/activeresource-2.3.3/lib/active_resource/base.rb</h2>

    

    <div class="report_table_wrapper">
      <table class='report' id='report_table'>
        <thead>
          <tr>
            <th class="left_align">Name</th>
            <th class="right_align">Total Lines</th>
            <th class="right_align">Lines of Code</th>
            <th class="left_align">Total Coverage</th>
            <th class="left_align">Code Coverage</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="left_align"><a href="-Library-Ruby-Gems-1_8-gems-activeresource-2_3_3-lib-active_resource-base_rb.html">/Library/Ruby/Gems/1.8/gems/activeresource-2.3.3/lib/active_resource/base.rb</a></td>
            <td class='right_align'><tt>1083</tt></td>
            <td class='right_align'><tt>377</tt></td>
            <td class="left_align"><div class="percent_graph_legend"><tt class=''>69.53%</tt></div>
          <div class="percent_graph">
            <div class="covered" style="width:70px"></div>
            <div class="uncovered" style="width:30px"></div>
          </div></td>
            <td class="left_align"><div class="percent_graph_legend"><tt class=''>21.75%</tt></div>
          <div class="percent_graph">
            <div class="covered" style="width:22px"></div>
            <div class="uncovered" style="width:78px"></div>
          </div></td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <h3>Key</h3>
    
    <div class="key"><pre><span class='marked'>Code reported as executed by Ruby looks like this...</span><span class='marked1'>and this: this line is also marked as covered.</span><span class='inferred'>Lines considered as run by rcov, but not reported by Ruby, look like this,</span><span class='inferred1'>and this: these lines were inferred by rcov (using simple heuristics).</span><span class='uncovered'>Finally, here's a line marked as not executed.</span></pre></div>

    <h3>Coverage Details</h3>

    <table class="details">
      <tbody>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1">1</a> require 'active_resource/connection'</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line2">2</a> require 'cgi'</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line3">3</a> require 'set'</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line4">4</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line5">5</a> module ActiveResource</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line6">6</a>   # ActiveResource::Base is the main class for mapping RESTful resources as models in a Rails application.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line7">7</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line8">8</a>   # For an outline of what Active Resource is capable of, see link:files/vendor/rails/activeresource/README.html.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line9">9</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line10">10</a>   # == Automated mapping</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line11">11</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line12">12</a>   # Active Resource objects represent your RESTful resources as manipulatable Ruby objects.  To map resources</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line13">13</a>   # to Ruby objects, Active Resource only needs a class name that corresponds to the resource name (e.g., the class</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line14">14</a>   # Person maps to the resources people, very similarly to Active Record) and a +site+ value, which holds the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line15">15</a>   # URI of the resources.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line16">16</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line17">17</a>   #   class Person &lt; ActiveResource::Base</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line18">18</a>   #     self.site = &quot;http://api.people.com:3000/&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line19">19</a>   #   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line20">20</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line21">21</a>   # Now the Person class is mapped to RESTful resources located at &lt;tt&gt;http://api.people.com:3000/people/&lt;/tt&gt;, and</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line22">22</a>   # you can now use Active Resource's lifecycles methods to manipulate resources. In the case where you already have</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line23">23</a>   # an existing model with the same name as the desired RESTful resource you can set the +element_name+ value.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line24">24</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line25">25</a>   #   class PersonResource &lt; ActiveResource::Base</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line26">26</a>   #     self.site = &quot;http://api.people.com:3000/&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line27">27</a>   #     self.element_name = &quot;person&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line28">28</a>   #   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line29">29</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line30">30</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line31">31</a>   # == Lifecycle methods</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line32">32</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line33">33</a>   # Active Resource exposes methods for creating, finding, updating, and deleting resources</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line34">34</a>   # from REST web services.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line35">35</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line36">36</a>   #   ryan = Person.new(:first =&gt; 'Ryan', :last =&gt; 'Daigle')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line37">37</a>   #   ryan.save                # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line38">38</a>   #   ryan.id                  # =&gt; 2</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line39">39</a>   #   Person.exists?(ryan.id)  # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line40">40</a>   #   ryan.exists?             # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line41">41</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line42">42</a>   #   ryan = Person.find(1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line43">43</a>   #   # Resource holding our newly created Person object</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line44">44</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line45">45</a>   #   ryan.first = 'Rizzle'</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line46">46</a>   #   ryan.save                # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line47">47</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line48">48</a>   #   ryan.destroy             # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line49">49</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line50">50</a>   # As you can see, these are very similar to Active Record's lifecycle methods for database records.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line51">51</a>   # You can read more about each of these methods in their respective documentation.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line52">52</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line53">53</a>   # === Custom REST methods</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line54">54</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line55">55</a>   # Since simple CRUD/lifecycle methods can't accomplish every task, Active Resource also supports</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line56">56</a>   # defining your own custom REST methods. To invoke them, Active Resource provides the &lt;tt&gt;get&lt;/tt&gt;,</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line57">57</a>   # &lt;tt&gt;post&lt;/tt&gt;, &lt;tt&gt;put&lt;/tt&gt; and &lt;tt&gt;\delete&lt;/tt&gt; methods where you can specify a custom REST method</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line58">58</a>   # name to invoke.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line59">59</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line60">60</a>   #   # POST to the custom 'register' REST method, i.e. POST /people/new/register.xml.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line61">61</a>   #   Person.new(:name =&gt; 'Ryan').post(:register)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line62">62</a>   #   # =&gt; { :id =&gt; 1, :name =&gt; 'Ryan', :position =&gt; 'Clerk' }</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line63">63</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line64">64</a>   #   # PUT an update by invoking the 'promote' REST method, i.e. PUT /people/1/promote.xml?position=Manager.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line65">65</a>   #   Person.find(1).put(:promote, :position =&gt; 'Manager')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line66">66</a>   #   # =&gt; { :id =&gt; 1, :name =&gt; 'Ryan', :position =&gt; 'Manager' }</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line67">67</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line68">68</a>   #   # GET all the positions available, i.e. GET /people/positions.xml.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line69">69</a>   #   Person.get(:positions)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line70">70</a>   #   # =&gt; [{:name =&gt; 'Manager'}, {:name =&gt; 'Clerk'}]</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line71">71</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line72">72</a>   #   # DELETE to 'fire' a person, i.e. DELETE /people/1/fire.xml.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line73">73</a>   #   Person.find(1).delete(:fire)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line74">74</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line75">75</a>   # For more information on using custom REST methods, see the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line76">76</a>   # ActiveResource::CustomMethods documentation.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line77">77</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line78">78</a>   # == Validations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line79">79</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line80">80</a>   # You can validate resources client side by overriding validation methods in the base class.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line81">81</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line82">82</a>   #   class Person &lt; ActiveResource::Base</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line83">83</a>   #      self.site = &quot;http://api.people.com:3000/&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line84">84</a>   #      protected</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line85">85</a>   #        def validate</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line86">86</a>   #          errors.add(&quot;last&quot;, &quot;has invalid characters&quot;) unless last =~ /[a-zA-Z]*/</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line87">87</a>   #        end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line88">88</a>   #   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line89">89</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line90">90</a>   # See the ActiveResource::Validations documentation for more information.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line91">91</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line92">92</a>   # == Authentication</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line93">93</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line94">94</a>   # Many REST APIs will require authentication, usually in the form of basic</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line95">95</a>   # HTTP authentication.  Authentication can be specified by:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line96">96</a>   # * putting the credentials in the URL for the +site+ variable.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line97">97</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line98">98</a>   #    class Person &lt; ActiveResource::Base</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line99">99</a>   #      self.site = &quot;http://ryan:password@api.people.com:3000/&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line100">100</a>   #    end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line101">101</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line102">102</a>   # * defining +user+ and/or +password+ variables</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line103">103</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line104">104</a>   #    class Person &lt; ActiveResource::Base</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line105">105</a>   #      self.site = &quot;http://api.people.com:3000/&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line106">106</a>   #      self.user = &quot;ryan&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line107">107</a>   #      self.password = &quot;password&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line108">108</a>   #    end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line109">109</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line110">110</a>   # For obvious security reasons, it is probably best if such services are available</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line111">111</a>   # over HTTPS.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line112">112</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line113">113</a>   # Note: Some values cannot be provided in the URL passed to site.  e.g. email addresses</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line114">114</a>   # as usernames.  In those situations you should use the separate user and password option.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line115">115</a>   # == Errors &amp; Validation</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line116">116</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line117">117</a>   # Error handling and validation is handled in much the same manner as you're used to seeing in</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line118">118</a>   # Active Record.  Both the response code in the HTTP response and the body of the response are used to</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line119">119</a>   # indicate that an error occurred.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line120">120</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line121">121</a>   # === Resource errors</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line122">122</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line123">123</a>   # When a GET is requested for a resource that does not exist, the HTTP &lt;tt&gt;404&lt;/tt&gt; (Resource Not Found)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line124">124</a>   # response code will be returned from the server which will raise an ActiveResource::ResourceNotFound</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line125">125</a>   # exception.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line126">126</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line127">127</a>   #   # GET http://api.people.com:3000/people/999.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line128">128</a>   #   ryan = Person.find(999) # 404, raises ActiveResource::ResourceNotFound</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line129">129</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line130">130</a>   # &lt;tt&gt;404&lt;/tt&gt; is just one of the HTTP error response codes that Active Resource will handle with its own exception. The</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line131">131</a>   # following HTTP response codes will also result in these exceptions:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line132">132</a>   # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line133">133</a>   # * 200..399 - Valid response, no exception (other than 301, 302)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line134">134</a>   # * 301, 302 - ActiveResource::Redirection</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line135">135</a>   # * 400 - ActiveResource::BadRequest</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line136">136</a>   # * 401 - ActiveResource::UnauthorizedAccess</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line137">137</a>   # * 403 - ActiveResource::ForbiddenAccess</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line138">138</a>   # * 404 - ActiveResource::ResourceNotFound</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line139">139</a>   # * 405 - ActiveResource::MethodNotAllowed</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line140">140</a>   # * 409 - ActiveResource::ResourceConflict</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line141">141</a>   # * 422 - ActiveResource::ResourceInvalid (rescued by save as validation errors)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line142">142</a>   # * 401..499 - ActiveResource::ClientError</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line143">143</a>   # * 500..599 - ActiveResource::ServerError</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line144">144</a>   # * Other - ActiveResource::ConnectionError</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line145">145</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line146">146</a>   # These custom exceptions allow you to deal with resource errors more naturally and with more precision</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line147">147</a>   # rather than returning a general HTTP error.  For example:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line148">148</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line149">149</a>   #   begin</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line150">150</a>   #     ryan = Person.find(my_id)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line151">151</a>   #   rescue ActiveResource::ResourceNotFound</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line152">152</a>   #     redirect_to :action =&gt; 'not_found'</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line153">153</a>   #   rescue ActiveResource::ResourceConflict, ActiveResource::ResourceInvalid</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line154">154</a>   #     redirect_to :action =&gt; 'new'</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line155">155</a>   #   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line156">156</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line157">157</a>   # === Validation errors</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line158">158</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line159">159</a>   # Active Resource supports validations on resources and will return errors if any these validations fail</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line160">160</a>   # (e.g., &quot;First name can not be blank&quot; and so on).  These types of errors are denoted in the response by</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line161">161</a>   # a response code of &lt;tt&gt;422&lt;/tt&gt; and an XML representation of the validation errors.  The save operation will</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line162">162</a>   # then fail (with a &lt;tt&gt;false&lt;/tt&gt; return value) and the validation errors can be accessed on the resource in question.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line163">163</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line164">164</a>   #   ryan = Person.find(1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line165">165</a>   #   ryan.first # =&gt; ''</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line166">166</a>   #   ryan.save  # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line167">167</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line168">168</a>   #   # When</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line169">169</a>   #   # PUT http://api.people.com:3000/people/1.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line170">170</a>   #   # is requested with invalid values, the response is:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line171">171</a>   #   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line172">172</a>   #   # Response (422):</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line173">173</a>   #   # &lt;errors type=&quot;array&quot;&gt;&lt;error&gt;First cannot be empty&lt;/error&gt;&lt;/errors&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line174">174</a>   #   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line175">175</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line176">176</a>   #   ryan.errors.invalid?(:first)  # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line177">177</a>   #   ryan.errors.full_messages     # =&gt; ['First cannot be empty']</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line178">178</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line179">179</a>   # Learn more about Active Resource's validation features in the ActiveResource::Validations documentation.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line180">180</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line181">181</a>   # === Timeouts</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line182">182</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line183">183</a>   # Active Resource relies on HTTP to access RESTful APIs and as such is inherently susceptible to slow or</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line184">184</a>   # unresponsive servers. In such cases, your Active Resource method calls could \timeout. You can control the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line185">185</a>   # amount of time before Active Resource times out with the +timeout+ variable.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line186">186</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line187">187</a>   #   class Person &lt; ActiveResource::Base</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line188">188</a>   #     self.site = &quot;http://api.people.com:3000/&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line189">189</a>   #     self.timeout = 5</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line190">190</a>   #   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line191">191</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line192">192</a>   # This sets the +timeout+ to 5 seconds. You can adjust the +timeout+ to a value suitable for the RESTful API</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line193">193</a>   # you are accessing. It is recommended to set this to a reasonably low value to allow your Active Resource</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line194">194</a>   # clients (especially if you are using Active Resource in a Rails application) to fail-fast (see</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line195">195</a>   # http://en.wikipedia.org/wiki/Fail-fast) rather than cause cascading failures that could incapacitate your</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line196">196</a>   # server.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line197">197</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line198">198</a>   # When a \timeout occurs, an ActiveResource::TimeoutError is raised. You should rescue from</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line199">199</a>   # ActiveResource::TimeoutError in your Active Resource method calls.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line200">200</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line201">201</a>   # Internally, Active Resource relies on Ruby's Net::HTTP library to make HTTP requests. Setting +timeout+</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line202">202</a>   # sets the &lt;tt&gt;read_timeout&lt;/tt&gt; of the internal Net::HTTP instance to the same value. The default</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line203">203</a>   # &lt;tt&gt;read_timeout&lt;/tt&gt; is 60 seconds on most Ruby implementations.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line204">204</a>   class Base</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line205">205</a>     ##</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line206">206</a>     # :singleton-method:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line207">207</a>     # The logger for diagnosing and tracing Active Resource calls.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line208">208</a>     cattr_accessor :logger</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line209">209</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line210">210</a>     class &lt;&lt; self</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line211">211</a>       # Gets the URI of the REST resources to map for this class.  The site variable is required for</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line212">212</a>       # Active Resource's mapping to work.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line213">213</a>       def site</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line214">214</a>         # Not using superclass_delegating_reader because don't want subclasses to modify superclass instance</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line215">215</a>         #</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line216">216</a>         # With superclass_delegating_reader</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line217">217</a>         #</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line218">218</a>         #   Parent.site = 'http://anonymous@test.com'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line219">219</a>         #   Subclass.site # =&gt; 'http://anonymous@test.com'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line220">220</a>         #   Subclass.site.user = 'david'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line221">221</a>         #   Parent.site # =&gt; 'http://david@test.com'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line222">222</a>         #</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line223">223</a>         # Without superclass_delegating_reader (expected behaviour)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line224">224</a>         #</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line225">225</a>         #   Parent.site = 'http://anonymous@test.com'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line226">226</a>         #   Subclass.site # =&gt; 'http://anonymous@test.com'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line227">227</a>         #   Subclass.site.user = 'david' # =&gt; TypeError: can't modify frozen object</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line228">228</a>         #</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line229">229</a>         if defined?(@site)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line230">230</a>           @site</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line231">231</a>         elsif superclass != Object &amp;&amp; superclass.site</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line232">232</a>           superclass.site.dup.freeze</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line233">233</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line234">234</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line235">235</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line236">236</a>       # Sets the URI of the REST resources to map for this class to the value in the +site+ argument.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line237">237</a>       # The site variable is required for Active Resource's mapping to work.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line238">238</a>       def site=(site)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line239">239</a>         @connection = nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line240">240</a>         if site.nil?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line241">241</a>           @site = nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line242">242</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line243">243</a>           @site = create_site_uri_from(site)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line244">244</a>           @user = URI.decode(@site.user) if @site.user</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line245">245</a>           @password = URI.decode(@site.password) if @site.password</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line246">246</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line247">247</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line248">248</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line249">249</a>       # Gets the \user for REST HTTP authentication.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line250">250</a>       def user</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line251">251</a>         # Not using superclass_delegating_reader. See +site+ for explanation</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line252">252</a>         if defined?(@user)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line253">253</a>           @user</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line254">254</a>         elsif superclass != Object &amp;&amp; superclass.user</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line255">255</a>           superclass.user.dup.freeze</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line256">256</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line257">257</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line258">258</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line259">259</a>       # Sets the \user for REST HTTP authentication.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line260">260</a>       def user=(user)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line261">261</a>         @connection = nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line262">262</a>         @user = user</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line263">263</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line264">264</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line265">265</a>       # Gets the \password for REST HTTP authentication.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line266">266</a>       def password</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line267">267</a>         # Not using superclass_delegating_reader. See +site+ for explanation</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line268">268</a>         if defined?(@password)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line269">269</a>           @password</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line270">270</a>         elsif superclass != Object &amp;&amp; superclass.password</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line271">271</a>           superclass.password.dup.freeze</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line272">272</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line273">273</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line274">274</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line275">275</a>       # Sets the \password for REST HTTP authentication.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line276">276</a>       def password=(password)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line277">277</a>         @connection = nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line278">278</a>         @password = password</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line279">279</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line280">280</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line281">281</a>       # Sets the format that attributes are sent and received in from a mime type reference:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line282">282</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line283">283</a>       #   Person.format = :json</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line284">284</a>       #   Person.find(1) # =&gt; GET /people/1.json</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line285">285</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line286">286</a>       #   Person.format = ActiveResource::Formats::XmlFormat</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line287">287</a>       #   Person.find(1) # =&gt; GET /people/1.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line288">288</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line289">289</a>       # Default format is &lt;tt&gt;:xml&lt;/tt&gt;.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line290">290</a>       def format=(mime_type_reference_or_format)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line291">291</a>         format = mime_type_reference_or_format.is_a?(Symbol) ?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line292">292</a>           ActiveResource::Formats[mime_type_reference_or_format] : mime_type_reference_or_format</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line293">293</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line294">294</a>         write_inheritable_attribute(:format, format)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line295">295</a>         connection.format = format if site</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line296">296</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line297">297</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line298">298</a>       # Returns the current format, default is ActiveResource::Formats::XmlFormat.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line299">299</a>       def format</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line300">300</a>         read_inheritable_attribute(:format) || ActiveResource::Formats[:xml]</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line301">301</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line302">302</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line303">303</a>       # Sets the number of seconds after which requests to the REST API should time out.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line304">304</a>       def timeout=(timeout)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line305">305</a>         @connection = nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line306">306</a>         @timeout = timeout</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line307">307</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line308">308</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line309">309</a>       # Gets the number of seconds after which requests to the REST API should time out.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line310">310</a>       def timeout</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line311">311</a>         if defined?(@timeout)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line312">312</a>           @timeout</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line313">313</a>         elsif superclass != Object &amp;&amp; superclass.timeout</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line314">314</a>           superclass.timeout</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line315">315</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line316">316</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line317">317</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line318">318</a>       # An instance of ActiveResource::Connection that is the base \connection to the remote service.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line319">319</a>       # The +refresh+ parameter toggles whether or not the \connection is refreshed at every request</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line320">320</a>       # or not (defaults to &lt;tt&gt;false&lt;/tt&gt;).</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line321">321</a>       def connection(refresh = false)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line322">322</a>         if defined?(@connection) || superclass == Object</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line323">323</a>           @connection = Connection.new(site, format) if refresh || @connection.nil?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line324">324</a>           @connection.user = user if user</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line325">325</a>           @connection.password = password if password</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line326">326</a>           @connection.timeout = timeout if timeout</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line327">327</a>           @connection</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line328">328</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line329">329</a>           superclass.connection</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line330">330</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line331">331</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line332">332</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line333">333</a>       def headers</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line334">334</a>         @headers ||= {}</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line335">335</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line336">336</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line337">337</a>       # Do not include any modules in the default element name. This makes it easier to seclude ARes objects</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line338">338</a>       # in a separate namespace without having to set element_name repeatedly.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line339">339</a>       attr_accessor_with_default(:element_name)    { to_s.split(&quot;::&quot;).last.underscore } #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line340">340</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line341">341</a>       attr_accessor_with_default(:collection_name) { element_name.pluralize } #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line342">342</a>       attr_accessor_with_default(:primary_key, 'id') #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line343">343</a>       </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line344">344</a>       # Gets the \prefix for a resource's nested URL (e.g., &lt;tt&gt;prefix/collectionname/1.xml&lt;/tt&gt;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line345">345</a>       # This method is regenerated at runtime based on what the \prefix is set to.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line346">346</a>       def prefix(options={})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line347">347</a>         default = site.path</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line348">348</a>         default &lt;&lt; '/' unless default[-1..-1] == '/'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line349">349</a>         # generate the actual method based on the current site path</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line350">350</a>         self.prefix = default</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line351">351</a>         prefix(options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line352">352</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line353">353</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line354">354</a>       # An attribute reader for the source string for the resource path \prefix.  This</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line355">355</a>       # method is regenerated at runtime based on what the \prefix is set to.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line356">356</a>       def prefix_source</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line357">357</a>         prefix # generate #prefix and #prefix_source methods first</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line358">358</a>         prefix_source</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line359">359</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line360">360</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line361">361</a>       # Sets the \prefix for a resource's nested URL (e.g., &lt;tt&gt;prefix/collectionname/1.xml&lt;/tt&gt;).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line362">362</a>       # Default value is &lt;tt&gt;site.path&lt;/tt&gt;.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line363">363</a>       def prefix=(value = '/')</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line364">364</a>         # Replace :placeholders with '#{embedded options[:lookups]}'</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line365">365</a>         prefix_call = value.gsub(/:\w+/) { |key| &quot;\#{options[#{key}]}&quot; }</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line366">366</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line367">367</a>         # Clear prefix parameters in case they have been cached</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line368">368</a>         @prefix_parameters = nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line369">369</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line370">370</a>         # Redefine the new methods.</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line371">371</a>         code = &lt;&lt;-end_code</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line372">372</a>           def prefix_source() &quot;#{value}&quot; end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line373">373</a>           def prefix(options={}) &quot;#{prefix_call}&quot; end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line374">374</a>         end_code</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line375">375</a>         silence_warnings { instance_eval code, __FILE__, __LINE__ }</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line376">376</a>       rescue</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line377">377</a>         logger.error &quot;Couldn't set prefix: #{$!}\n  #{code}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line378">378</a>         raise</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line379">379</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line380">380</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line381">381</a>       alias_method :set_prefix, :prefix=  #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line382">382</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line383">383</a>       alias_method :set_element_name, :element_name=  #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line384">384</a>       alias_method :set_collection_name, :collection_name=  #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line385">385</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line386">386</a>       # Gets the element path for the given ID in +id+.  If the +query_options+ parameter is omitted, Rails</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line387">387</a>       # will split from the \prefix options.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line388">388</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line389">389</a>       # ==== Options</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line390">390</a>       # +prefix_options+ - A \hash to add a \prefix to the request for nested URLs (e.g., &lt;tt&gt;:account_id =&gt; 19&lt;/tt&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line391">391</a>       #                    would yield a URL like &lt;tt&gt;/accounts/19/purchases.xml&lt;/tt&gt;).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line392">392</a>       # +query_options+ - A \hash to add items to the query string for the request.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line393">393</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line394">394</a>       # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line395">395</a>       #   Post.element_path(1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line396">396</a>       #   # =&gt; /posts/1.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line397">397</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line398">398</a>       #   Comment.element_path(1, :post_id =&gt; 5)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line399">399</a>       #   # =&gt; /posts/5/comments/1.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line400">400</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line401">401</a>       #   Comment.element_path(1, :post_id =&gt; 5, :active =&gt; 1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line402">402</a>       #   # =&gt; /posts/5/comments/1.xml?active=1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line403">403</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line404">404</a>       #   Comment.element_path(1, {:post_id =&gt; 5}, {:active =&gt; 1})</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line405">405</a>       #   # =&gt; /posts/5/comments/1.xml?active=1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line406">406</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line407">407</a>       def element_path(id, prefix_options = {}, query_options = nil)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line408">408</a>         prefix_options, query_options = split_options(prefix_options) if query_options.nil?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line409">409</a>         &quot;#{prefix(prefix_options)}#{collection_name}/#{id}.#{format.extension}#{query_string(query_options)}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line410">410</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line411">411</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line412">412</a>       # Gets the collection path for the REST resources.  If the +query_options+ parameter is omitted, Rails</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line413">413</a>       # will split from the +prefix_options+.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line414">414</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line415">415</a>       # ==== Options</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line416">416</a>       # * +prefix_options+ - A hash to add a prefix to the request for nested URL's (e.g., &lt;tt&gt;:account_id =&gt; 19&lt;/tt&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line417">417</a>       #   would yield a URL like &lt;tt&gt;/accounts/19/purchases.xml&lt;/tt&gt;).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line418">418</a>       # * +query_options+ - A hash to add items to the query string for the request.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line419">419</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line420">420</a>       # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line421">421</a>       #   Post.collection_path</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line422">422</a>       #   # =&gt; /posts.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line423">423</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line424">424</a>       #   Comment.collection_path(:post_id =&gt; 5)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line425">425</a>       #   # =&gt; /posts/5/comments.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line426">426</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line427">427</a>       #   Comment.collection_path(:post_id =&gt; 5, :active =&gt; 1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line428">428</a>       #   # =&gt; /posts/5/comments.xml?active=1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line429">429</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line430">430</a>       #   Comment.collection_path({:post_id =&gt; 5}, {:active =&gt; 1})</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line431">431</a>       #   # =&gt; /posts/5/comments.xml?active=1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line432">432</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line433">433</a>       def collection_path(prefix_options = {}, query_options = nil)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line434">434</a>         prefix_options, query_options = split_options(prefix_options) if query_options.nil?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line435">435</a>         &quot;#{prefix(prefix_options)}#{collection_name}.#{format.extension}#{query_string(query_options)}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line436">436</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line437">437</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line438">438</a>       alias_method :set_primary_key, :primary_key=  #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line439">439</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line440">440</a>       # Creates a new resource instance and makes a request to the remote service</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line441">441</a>       # that it be saved, making it equivalent to the following simultaneous calls:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line442">442</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line443">443</a>       #   ryan = Person.new(:first =&gt; 'ryan')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line444">444</a>       #   ryan.save</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line445">445</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line446">446</a>       # Returns the newly created resource.  If a failure has occurred an</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line447">447</a>       # exception will be raised (see &lt;tt&gt;save&lt;/tt&gt;).  If the resource is invalid and</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line448">448</a>       # has not been saved then &lt;tt&gt;valid?&lt;/tt&gt; will return &lt;tt&gt;false&lt;/tt&gt;,</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line449">449</a>       # while &lt;tt&gt;new?&lt;/tt&gt; will still return &lt;tt&gt;true&lt;/tt&gt;.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line450">450</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line451">451</a>       # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line452">452</a>       #   Person.create(:name =&gt; 'Jeremy', :email =&gt; 'myname@nospam.com', :enabled =&gt; true)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line453">453</a>       #   my_person = Person.find(:first)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line454">454</a>       #   my_person.email # =&gt; myname@nospam.com</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line455">455</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line456">456</a>       #   dhh = Person.create(:name =&gt; 'David', :email =&gt; 'dhh@nospam.com', :enabled =&gt; true)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line457">457</a>       #   dhh.valid? # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line458">458</a>       #   dhh.new?   # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line459">459</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line460">460</a>       #   # We'll assume that there's a validation that requires the name attribute</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line461">461</a>       #   that_guy = Person.create(:name =&gt; '', :email =&gt; 'thatguy@nospam.com', :enabled =&gt; true)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line462">462</a>       #   that_guy.valid? # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line463">463</a>       #   that_guy.new?   # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line464">464</a>       def create(attributes = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line465">465</a>         self.new(attributes).tap { |resource| resource.save }</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line466">466</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line467">467</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line468">468</a>       # Core method for finding resources.  Used similarly to Active Record's +find+ method.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line469">469</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line470">470</a>       # ==== Arguments</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line471">471</a>       # The first argument is considered to be the scope of the query.  That is, how many</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line472">472</a>       # resources are returned from the request.  It can be one of the following.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line473">473</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line474">474</a>       # * &lt;tt&gt;:one&lt;/tt&gt; - Returns a single resource.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line475">475</a>       # * &lt;tt&gt;:first&lt;/tt&gt; - Returns the first resource found.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line476">476</a>       # * &lt;tt&gt;:last&lt;/tt&gt; - Returns the last resource found.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line477">477</a>       # * &lt;tt&gt;:all&lt;/tt&gt; - Returns every resource that matches the request.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line478">478</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line479">479</a>       # ==== Options</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line480">480</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line481">481</a>       # * &lt;tt&gt;:from&lt;/tt&gt; - Sets the path or custom method that resources will be fetched from.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line482">482</a>       # * &lt;tt&gt;:params&lt;/tt&gt; - Sets query and \prefix (nested URL) parameters.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line483">483</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line484">484</a>       # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line485">485</a>       #   Person.find(1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line486">486</a>       #   # =&gt; GET /people/1.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line487">487</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line488">488</a>       #   Person.find(:all)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line489">489</a>       #   # =&gt; GET /people.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line490">490</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line491">491</a>       #   Person.find(:all, :params =&gt; { :title =&gt; &quot;CEO&quot; })</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line492">492</a>       #   # =&gt; GET /people.xml?title=CEO</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line493">493</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line494">494</a>       #   Person.find(:first, :from =&gt; :managers)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line495">495</a>       #   # =&gt; GET /people/managers.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line496">496</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line497">497</a>       #   Person.find(:last, :from =&gt; :managers)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line498">498</a>       #   # =&gt; GET /people/managers.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line499">499</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line500">500</a>       #   Person.find(:all, :from =&gt; &quot;/companies/1/people.xml&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line501">501</a>       #   # =&gt; GET /companies/1/people.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line502">502</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line503">503</a>       #   Person.find(:one, :from =&gt; :leader)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line504">504</a>       #   # =&gt; GET /people/leader.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line505">505</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line506">506</a>       #   Person.find(:all, :from =&gt; :developers, :params =&gt; { :language =&gt; 'ruby' })</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line507">507</a>       #   # =&gt; GET /people/developers.xml?language=ruby</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line508">508</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line509">509</a>       #   Person.find(:one, :from =&gt; &quot;/companies/1/manager.xml&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line510">510</a>       #   # =&gt; GET /companies/1/manager.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line511">511</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line512">512</a>       #   StreetAddress.find(1, :params =&gt; { :person_id =&gt; 1 })</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line513">513</a>       #   # =&gt; GET /people/1/street_addresses/1.xml</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line514">514</a>       def find(*arguments)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line515">515</a>         scope   = arguments.slice!(0)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line516">516</a>         options = arguments.slice!(0) || {}</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line517">517</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line518">518</a>         case scope</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line519">519</a>           when :all   then find_every(options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line520">520</a>           when :first then find_every(options).first</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line521">521</a>           when :last  then find_every(options).last</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line522">522</a>           when :one   then find_one(options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line523">523</a>           else             find_single(scope, options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line524">524</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line525">525</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line526">526</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line527">527</a>       # Deletes the resources with the ID in the +id+ parameter.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line528">528</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line529">529</a>       # ==== Options</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line530">530</a>       # All options specify \prefix and query parameters.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line531">531</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line532">532</a>       # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line533">533</a>       #   Event.delete(2) # sends DELETE /events/2</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line534">534</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line535">535</a>       #   Event.create(:name =&gt; 'Free Concert', :location =&gt; 'Community Center')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line536">536</a>       #   my_event = Event.find(:first) # let's assume this is event with ID 7</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line537">537</a>       #   Event.delete(my_event.id) # sends DELETE /events/7</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line538">538</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line539">539</a>       #   # Let's assume a request to events/5/cancel.xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line540">540</a>       #   Event.delete(params[:id]) # sends DELETE /events/5</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line541">541</a>       def delete(id, options = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line542">542</a>         connection.delete(element_path(id, options))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line543">543</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line544">544</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line545">545</a>       # Asserts the existence of a resource, returning &lt;tt&gt;true&lt;/tt&gt; if the resource is found.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line546">546</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line547">547</a>       # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line548">548</a>       #   Note.create(:title =&gt; 'Hello, world.', :body =&gt; 'Nothing more for now...')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line549">549</a>       #   Note.exists?(1) # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line550">550</a>       #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line551">551</a>       #   Note.exists(1349) # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line552">552</a>       def exists?(id, options = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line553">553</a>         if id</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line554">554</a>           prefix_options, query_options = split_options(options[:params])</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line555">555</a>           path = element_path(id, prefix_options, query_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line556">556</a>           response = connection.head(path, headers)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line557">557</a>           response.code.to_i == 200</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line558">558</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line559">559</a>         # id &amp;&amp; !find_single(id, options).nil?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line560">560</a>       rescue ActiveResource::ResourceNotFound</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line561">561</a>         false</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line562">562</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line563">563</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line564">564</a>       private</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line565">565</a>         # Find every resource</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line566">566</a>         def find_every(options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line567">567</a>           case from = options[:from]</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line568">568</a>           when Symbol</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line569">569</a>             instantiate_collection(get(from, options[:params]))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line570">570</a>           when String</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line571">571</a>             path = &quot;#{from}#{query_string(options[:params])}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line572">572</a>             instantiate_collection(connection.get(path, headers) || [])</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line573">573</a>           else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line574">574</a>             prefix_options, query_options = split_options(options[:params])</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line575">575</a>             path = collection_path(prefix_options, query_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line576">576</a>             instantiate_collection( (connection.get(path, headers) || []), prefix_options )</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line577">577</a>           end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line578">578</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line579">579</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line580">580</a>         # Find a single resource from a one-off URL</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line581">581</a>         def find_one(options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line582">582</a>           case from = options[:from]</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line583">583</a>           when Symbol</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line584">584</a>             instantiate_record(get(from, options[:params]))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line585">585</a>           when String</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line586">586</a>             path = &quot;#{from}#{query_string(options[:params])}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line587">587</a>             instantiate_record(connection.get(path, headers))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line588">588</a>           end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line589">589</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line590">590</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line591">591</a>         # Find a single resource from the default URL</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line592">592</a>         def find_single(scope, options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line593">593</a>           prefix_options, query_options = split_options(options[:params])</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line594">594</a>           path = element_path(scope, prefix_options, query_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line595">595</a>           instantiate_record(connection.get(path, headers), prefix_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line596">596</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line597">597</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line598">598</a>         def instantiate_collection(collection, prefix_options = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line599">599</a>           collection.collect! { |record| instantiate_record(record, prefix_options) }</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line600">600</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line601">601</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line602">602</a>         def instantiate_record(record, prefix_options = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line603">603</a>           new(record).tap do |resource|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line604">604</a>             resource.prefix_options = prefix_options</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line605">605</a>           end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line606">606</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line607">607</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line608">608</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line609">609</a>         # Accepts a URI and creates the site URI from that.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line610">610</a>         def create_site_uri_from(site)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line611">611</a>           site.is_a?(URI) ? site.dup : URI.parse(site)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line612">612</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line613">613</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line614">614</a>         # contains a set of the current prefix parameters.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line615">615</a>         def prefix_parameters</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line616">616</a>           @prefix_parameters ||= prefix_source.scan(/:\w+/).map { |key| key[1..-1].to_sym }.to_set</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line617">617</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line618">618</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line619">619</a>         # Builds the query string for the request.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line620">620</a>         def query_string(options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line621">621</a>           &quot;?#{options.to_query}&quot; unless options.nil? || options.empty?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line622">622</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line623">623</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line624">624</a>         # split an option hash into two hashes, one containing the prefix options,</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line625">625</a>         # and the other containing the leftovers.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line626">626</a>         def split_options(options = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line627">627</a>           prefix_options, query_options = {}, {}</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line628">628</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line629">629</a>           (options || {}).each do |key, value|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line630">630</a>             next if key.blank?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line631">631</a>             (prefix_parameters.include?(key.to_sym) ? prefix_options : query_options)[key.to_sym] = value</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line632">632</a>           end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line633">633</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line634">634</a>           [ prefix_options, query_options ]</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line635">635</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line636">636</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line637">637</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line638">638</a>     attr_accessor :attributes #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line639">639</a>     attr_accessor :prefix_options #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line640">640</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line641">641</a>     # Constructor method for \new resources; the optional +attributes+ parameter takes a \hash</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line642">642</a>     # of attributes for the \new resource.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line643">643</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line644">644</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line645">645</a>     #   my_course = Course.new</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line646">646</a>     #   my_course.name = &quot;Western Civilization&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line647">647</a>     #   my_course.lecturer = &quot;Don Trotter&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line648">648</a>     #   my_course.save</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line649">649</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line650">650</a>     #   my_other_course = Course.new(:name =&gt; &quot;Philosophy: Reason and Being&quot;, :lecturer =&gt; &quot;Ralph Cling&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line651">651</a>     #   my_other_course.save</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line652">652</a>     def initialize(attributes = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line653">653</a>       @attributes     = {}</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line654">654</a>       @prefix_options = {}</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line655">655</a>       load(attributes)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line656">656</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line657">657</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line658">658</a>     # Returns a \clone of the resource that hasn't been assigned an +id+ yet and</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line659">659</a>     # is treated as a \new resource.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line660">660</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line661">661</a>     #   ryan = Person.find(1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line662">662</a>     #   not_ryan = ryan.clone</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line663">663</a>     #   not_ryan.new?  # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line664">664</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line665">665</a>     # Any active resource member attributes will NOT be cloned, though all other</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line666">666</a>     # attributes are.  This is to prevent the conflict between any +prefix_options+</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line667">667</a>     # that refer to the original parent resource and the newly cloned parent</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line668">668</a>     # resource that does not exist.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line669">669</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line670">670</a>     #   ryan = Person.find(1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line671">671</a>     #   ryan.address = StreetAddress.find(1, :person_id =&gt; ryan.id)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line672">672</a>     #   ryan.hash = {:not =&gt; &quot;an ARes instance&quot;}</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line673">673</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line674">674</a>     #   not_ryan = ryan.clone</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line675">675</a>     #   not_ryan.new?            # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line676">676</a>     #   not_ryan.address         # =&gt; NoMethodError</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line677">677</a>     #   not_ryan.hash            # =&gt; {:not =&gt; &quot;an ARes instance&quot;}</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line678">678</a>     def clone</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line679">679</a>       # Clone all attributes except the pk and any nested ARes</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line680">680</a>       cloned = attributes.reject {|k,v| k == self.class.primary_key || v.is_a?(ActiveResource::Base)}.inject({}) do |attrs, (k, v)|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line681">681</a>         attrs[k] = v.clone</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line682">682</a>         attrs</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line683">683</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line684">684</a>       # Form the new resource - bypass initialize of resource with 'new' as that will call 'load' which</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line685">685</a>       # attempts to convert hashes into member objects and arrays into collections of objects.  We want</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line686">686</a>       # the raw objects to be cloned so we bypass load by directly setting the attributes hash.</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line687">687</a>       resource = self.class.new({})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line688">688</a>       resource.prefix_options = self.prefix_options</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line689">689</a>       resource.send :instance_variable_set, '@attributes', cloned</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line690">690</a>       resource</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line691">691</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line692">692</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line693">693</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line694">694</a>     # A method to determine if the resource a \new object (i.e., it has not been POSTed to the remote service yet).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line695">695</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line696">696</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line697">697</a>     #   not_new = Computer.create(:brand =&gt; 'Apple', :make =&gt; 'MacBook', :vendor =&gt; 'MacMall')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line698">698</a>     #   not_new.new? # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line699">699</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line700">700</a>     #   is_new = Computer.new(:brand =&gt; 'IBM', :make =&gt; 'Thinkpad', :vendor =&gt; 'IBM')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line701">701</a>     #   is_new.new? # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line702">702</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line703">703</a>     #   is_new.save</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line704">704</a>     #   is_new.new? # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line705">705</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line706">706</a>     def new?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line707">707</a>       id.nil?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line708">708</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line709">709</a>     alias :new_record? :new?</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line710">710</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line711">711</a>     # Gets the &lt;tt&gt;\id&lt;/tt&gt; attribute of the resource.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line712">712</a>     def id</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line713">713</a>       attributes[self.class.primary_key]</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line714">714</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line715">715</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line716">716</a>     # Sets the &lt;tt&gt;\id&lt;/tt&gt; attribute of the resource.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line717">717</a>     def id=(id)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line718">718</a>       attributes[self.class.primary_key] = id</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line719">719</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line720">720</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line721">721</a>     # Allows Active Resource objects to be used as parameters in Action Pack URL generation.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line722">722</a>     def to_param</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line723">723</a>       id &amp;&amp; id.to_s</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line724">724</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line725">725</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line726">726</a>     # Test for equality.  Resource are equal if and only if +other+ is the same object or</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line727">727</a>     # is an instance of the same class, is not &lt;tt&gt;new?&lt;/tt&gt;, and has the same +id+.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line728">728</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line729">729</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line730">730</a>     #   ryan = Person.create(:name =&gt; 'Ryan')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line731">731</a>     #   jamie = Person.create(:name =&gt; 'Jamie')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line732">732</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line733">733</a>     #   ryan == jamie</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line734">734</a>     #   # =&gt; false (Different name attribute and id)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line735">735</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line736">736</a>     #   ryan_again = Person.new(:name =&gt; 'Ryan')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line737">737</a>     #   ryan == ryan_again</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line738">738</a>     #   # =&gt; false (ryan_again is new?)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line739">739</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line740">740</a>     #   ryans_clone = Person.create(:name =&gt; 'Ryan')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line741">741</a>     #   ryan == ryans_clone</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line742">742</a>     #   # =&gt; false (Different id attributes)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line743">743</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line744">744</a>     #   ryans_twin = Person.find(ryan.id)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line745">745</a>     #   ryan == ryans_twin</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line746">746</a>     #   # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line747">747</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line748">748</a>     def ==(other)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line749">749</a>       other.equal?(self) || (other.instance_of?(self.class) &amp;&amp; other.id == id &amp;&amp; other.prefix_options == prefix_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line750">750</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line751">751</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line752">752</a>     # Tests for equality (delegates to ==).</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line753">753</a>     def eql?(other)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line754">754</a>       self == other</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line755">755</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line756">756</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line757">757</a>     # Delegates to id in order to allow two resources of the same type and \id to work with something like:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line758">758</a>     #   [Person.find(1), Person.find(2)] &amp; [Person.find(1), Person.find(4)] # =&gt; [Person.find(1)]</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line759">759</a>     def hash</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line760">760</a>       id.hash</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line761">761</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line762">762</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line763">763</a>     # Duplicate the current resource without saving it.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line764">764</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line765">765</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line766">766</a>     #   my_invoice = Invoice.create(:customer =&gt; 'That Company')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line767">767</a>     #   next_invoice = my_invoice.dup</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line768">768</a>     #   next_invoice.new? # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line769">769</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line770">770</a>     #   next_invoice.save</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line771">771</a>     #   next_invoice == my_invoice # =&gt; false (different id attributes)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line772">772</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line773">773</a>     #   my_invoice.customer   # =&gt; That Company</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line774">774</a>     #   next_invoice.customer # =&gt; That Company</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line775">775</a>     def dup</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line776">776</a>       self.class.new.tap do |resource|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line777">777</a>         resource.attributes     = @attributes</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line778">778</a>         resource.prefix_options = @prefix_options</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line779">779</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line780">780</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line781">781</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line782">782</a>     # A method to \save (+POST+) or \update (+PUT+) a resource.  It delegates to +create+ if a \new object, </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line783">783</a>     # +update+ if it is existing. If the response to the \save includes a body, it will be assumed that this body</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line784">784</a>     # is XML for the final object as it looked after the \save (which would include attributes like +created_at+</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line785">785</a>     # that weren't part of the original submit).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line786">786</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line787">787</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line788">788</a>     #   my_company = Company.new(:name =&gt; 'RoleModel Software', :owner =&gt; 'Ken Auer', :size =&gt; 2)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line789">789</a>     #   my_company.new? # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line790">790</a>     #   my_company.save # sends POST /companies/ (create)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line791">791</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line792">792</a>     #   my_company.new? # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line793">793</a>     #   my_company.size = 10</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line794">794</a>     #   my_company.save # sends PUT /companies/1 (update)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line795">795</a>     def save</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line796">796</a>       new? ? create : update</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line797">797</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line798">798</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line799">799</a>     # Deletes the resource from the remote service.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line800">800</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line801">801</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line802">802</a>     #   my_id = 3</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line803">803</a>     #   my_person = Person.find(my_id)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line804">804</a>     #   my_person.destroy</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line805">805</a>     #   Person.find(my_id) # 404 (Resource Not Found)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line806">806</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line807">807</a>     #   new_person = Person.create(:name =&gt; 'James')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line808">808</a>     #   new_id = new_person.id # =&gt; 7</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line809">809</a>     #   new_person.destroy</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line810">810</a>     #   Person.find(new_id) # 404 (Resource Not Found)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line811">811</a>     def destroy</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line812">812</a>       connection.delete(element_path, self.class.headers)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line813">813</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line814">814</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line815">815</a>     # Evaluates to &lt;tt&gt;true&lt;/tt&gt; if this resource is not &lt;tt&gt;new?&lt;/tt&gt; and is</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line816">816</a>     # found on the remote service.  Using this method, you can check for</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line817">817</a>     # resources that may have been deleted between the object's instantiation</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line818">818</a>     # and actions on it.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line819">819</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line820">820</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line821">821</a>     #   Person.create(:name =&gt; 'Theodore Roosevelt')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line822">822</a>     #   that_guy = Person.find(:first)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line823">823</a>     #   that_guy.exists? # =&gt; true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line824">824</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line825">825</a>     #   that_lady = Person.new(:name =&gt; 'Paul Bean')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line826">826</a>     #   that_lady.exists? # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line827">827</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line828">828</a>     #   guys_id = that_guy.id</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line829">829</a>     #   Person.delete(guys_id)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line830">830</a>     #   that_guy.exists? # =&gt; false</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line831">831</a>     def exists?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line832">832</a>       !new? &amp;&amp; self.class.exists?(to_param, :params =&gt; prefix_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line833">833</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line834">834</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line835">835</a>      # Converts the resource to an XML string representation.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line836">836</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line837">837</a>     # ==== Options</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line838">838</a>     # The +options+ parameter is handed off to the +to_xml+ method on each</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line839">839</a>     # attribute, so it has the same options as the +to_xml+ methods in</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line840">840</a>     # Active Support.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line841">841</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line842">842</a>     # * &lt;tt&gt;:indent&lt;/tt&gt; - Set the indent level for the XML output (default is +2+).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line843">843</a>     # * &lt;tt&gt;:dasherize&lt;/tt&gt; - Boolean option to determine whether or not element names should</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line844">844</a>     #   replace underscores with dashes. Default is &lt;tt&gt;true&lt;/tt&gt;. The default can be set to &lt;tt&gt;false&lt;/tt&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line845">845</a>     #   by setting the module attribute &lt;tt&gt;ActiveSupport.dasherize_xml = false&lt;/tt&gt; in an initializer. Because save</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line846">846</a>     #   uses this method, and there are no options on save, then you will have to set the default if you don't</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line847">847</a>     #   want underscores in element names to become dashes when the resource is saved. This is important when</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line848">848</a>     #   integrating with non-Rails applications.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line849">849</a>     # * &lt;tt&gt;:camelize&lt;/tt&gt; - Boolean option to determine whether or not element names should be converted</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line850">850</a>     #   to camel case, e.g some_name to SomeName. Default is &lt;tt&gt;false&lt;/tt&gt;. Like &lt;tt&gt;:dasherize&lt;/tt&gt; you can</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line851">851</a>     #   change the default by setting the module attribute &lt;tt&gt;ActiveSupport.camelise_xml = true&lt;/tt&gt; in an initializer.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line852">852</a>     # * &lt;tt&gt;:skip_instruct&lt;/tt&gt; - Toggle skipping the +instruct!+ call on the XML builder</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line853">853</a>     #   that generates the XML declaration (default is &lt;tt&gt;false&lt;/tt&gt;).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line854">854</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line855">855</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line856">856</a>     #   my_group = SubsidiaryGroup.find(:first)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line857">857</a>     #   my_group.to_xml</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line858">858</a>     #   # =&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line859">859</a>     #   #    &lt;subsidiary_group&gt; [...] &lt;/subsidiary_group&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line860">860</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line861">861</a>     #   my_group.to_xml(:dasherize =&gt; true)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line862">862</a>     #   # =&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line863">863</a>     #   #    &lt;subsidiary-group&gt; [...] &lt;/subsidiary-group&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line864">864</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line865">865</a>     #   my_group.to_xml(:skip_instruct =&gt; true)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line866">866</a>     #   # =&gt; &lt;subsidiary_group&gt; [...] &lt;/subsidiary_group&gt;</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line867">867</a>     def to_xml(options={})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line868">868</a>       attributes.to_xml({:root =&gt; self.class.element_name}.merge(options))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line869">869</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line870">870</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line871">871</a>     # Coerces to a hash for JSON encoding.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line872">872</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line873">873</a>     # ==== Options</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line874">874</a>     # The +options+ are passed to the +to_json+ method on each</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line875">875</a>     # attribute, so the same options as the +to_json+ methods in</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line876">876</a>     # Active Support.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line877">877</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line878">878</a>     # * &lt;tt&gt;:only&lt;/tt&gt; - Only include the specified attribute or list of</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line879">879</a>     #   attributes in the serialized output. Attribute names must be specified</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line880">880</a>     #   as strings.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line881">881</a>     # * &lt;tt&gt;:except&lt;/tt&gt; - Do not include the specified attribute or list of</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line882">882</a>     #   attributes in the serialized output. Attribute names must be specified</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line883">883</a>     #   as strings.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line884">884</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line885">885</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line886">886</a>     #   person = Person.new(:first_name =&gt; &quot;Jim&quot;, :last_name =&gt; &quot;Smith&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line887">887</a>     #   person.to_json</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line888">888</a>     #   # =&gt; {&quot;first_name&quot;: &quot;Jim&quot;, &quot;last_name&quot;: &quot;Smith&quot;}</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line889">889</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line890">890</a>     #   person.to_json(:only =&gt; [&quot;first_name&quot;])</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line891">891</a>     #   # =&gt; {&quot;first_name&quot;: &quot;Jim&quot;}</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line892">892</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line893">893</a>     #   person.to_json(:except =&gt; [&quot;first_name&quot;])</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line894">894</a>     #   # =&gt; {&quot;last_name&quot;: &quot;Smith&quot;}</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line895">895</a>     def as_json(options = nil)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line896">896</a>       attributes.as_json(options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line897">897</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line898">898</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line899">899</a>     # Returns the serialized string representation of the resource in the configured</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line900">900</a>     # serialization format specified in ActiveResource::Base.format. The options</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line901">901</a>     # applicable depend on the configured encoding format.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line902">902</a>     def encode(options={})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line903">903</a>       case self.class.format</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line904">904</a>         when ActiveResource::Formats[:xml]</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line905">905</a>           self.class.format.encode(attributes, {:root =&gt; self.class.element_name}.merge(options))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line906">906</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line907">907</a>           self.class.format.encode(attributes, options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line908">908</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line909">909</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line910">910</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line911">911</a>     # A method to \reload the attributes of this object from the remote web service.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line912">912</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line913">913</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line914">914</a>     #   my_branch = Branch.find(:first)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line915">915</a>     #   my_branch.name # =&gt; &quot;Wislon Raod&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line916">916</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line917">917</a>     #   # Another client fixes the typo...</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line918">918</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line919">919</a>     #   my_branch.name # =&gt; &quot;Wislon Raod&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line920">920</a>     #   my_branch.reload</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line921">921</a>     #   my_branch.name # =&gt; &quot;Wilson Road&quot;</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line922">922</a>     def reload</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line923">923</a>       self.load(self.class.find(to_param, :params =&gt; @prefix_options).attributes)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line924">924</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line925">925</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line926">926</a>     # A method to manually load attributes from a \hash. Recursively loads collections of</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line927">927</a>     # resources.  This method is called in +initialize+ and +create+ when a \hash of attributes</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line928">928</a>     # is provided.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line929">929</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line930">930</a>     # ==== Examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line931">931</a>     #   my_attrs = {:name =&gt; 'J&amp;J Textiles', :industry =&gt; 'Cloth and textiles'}</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line932">932</a>     #   my_attrs = {:name =&gt; 'Marty', :colors =&gt; [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;]}</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line933">933</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line934">934</a>     #   the_supplier = Supplier.find(:first)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line935">935</a>     #   the_supplier.name # =&gt; 'J&amp;M Textiles'</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line936">936</a>     #   the_supplier.load(my_attrs)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line937">937</a>     #   the_supplier.name('J&amp;J Textiles')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line938">938</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line939">939</a>     #   # These two calls are the same as Supplier.new(my_attrs)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line940">940</a>     #   my_supplier = Supplier.new</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line941">941</a>     #   my_supplier.load(my_attrs)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line942">942</a>     #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line943">943</a>     #   # These three calls are the same as Supplier.create(my_attrs)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line944">944</a>     #   your_supplier = Supplier.new</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line945">945</a>     #   your_supplier.load(my_attrs)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line946">946</a>     #   your_supplier.save</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line947">947</a>     def load(attributes)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line948">948</a>       raise ArgumentError, &quot;expected an attributes Hash, got #{attributes.inspect}&quot; unless attributes.is_a?(Hash)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line949">949</a>       @prefix_options, attributes = split_options(attributes)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line950">950</a>       attributes.each do |key, value|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line951">951</a>         @attributes[key.to_s] =</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line952">952</a>           case value</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line953">953</a>             when Array</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line954">954</a>               resource = find_or_create_resource_for_collection(key)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line955">955</a>               value.map { |attrs| attrs.is_a?(String) ? attrs.dup : resource.new(attrs) }</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line956">956</a>             when Hash</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line957">957</a>               resource = find_or_create_resource_for(key)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line958">958</a>               resource.new(value)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line959">959</a>             else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line960">960</a>               value.dup rescue value</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line961">961</a>           end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line962">962</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line963">963</a>       self</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line964">964</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line965">965</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line966">966</a>     # For checking &lt;tt&gt;respond_to?&lt;/tt&gt; without searching the attributes (which is faster).</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line967">967</a>     alias_method :respond_to_without_attributes?, :respond_to?</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line968">968</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line969">969</a>     # A method to determine if an object responds to a message (e.g., a method call). In Active Resource, a Person object with a</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line970">970</a>     # +name+ attribute can answer &lt;tt&gt;true&lt;/tt&gt; to &lt;tt&gt;my_person.respond_to?(:name)&lt;/tt&gt;, &lt;tt&gt;my_person.respond_to?(:name=)&lt;/tt&gt;, and</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line971">971</a>     # &lt;tt&gt;my_person.respond_to?(:name?)&lt;/tt&gt;.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line972">972</a>     def respond_to?(method, include_priv = false)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line973">973</a>       method_name = method.to_s</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line974">974</a>       if attributes.nil?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line975">975</a>         return super</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line976">976</a>       elsif attributes.has_key?(method_name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line977">977</a>         return true</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line978">978</a>       elsif ['?','='].include?(method_name.last) &amp;&amp; attributes.has_key?(method_name.first(-1))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line979">979</a>         return true</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line980">980</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line981">981</a>       # super must be called at the end of the method, because the inherited respond_to?</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line982">982</a>       # would return true for generated readers, even if the attribute wasn't present</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line983">983</a>       super</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line984">984</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line985">985</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line986">986</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line987">987</a>     protected</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line988">988</a>       def connection(refresh = false)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line989">989</a>         self.class.connection(refresh)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line990">990</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line991">991</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line992">992</a>       # Update the resource on the remote service.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line993">993</a>       def update</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line994">994</a>         connection.put(element_path(prefix_options), encode, self.class.headers).tap do |response|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line995">995</a>           load_attributes_from_response(response)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line996">996</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line997">997</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line998">998</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line999">999</a>       # Create (i.e., \save to the remote service) the \new resource.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1000">1000</a>       def create</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1001">1001</a>         connection.post(collection_path, encode, self.class.headers).tap do |response|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1002">1002</a>           self.id = id_from_response(response)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1003">1003</a>           load_attributes_from_response(response)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1004">1004</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1005">1005</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1006">1006</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1007">1007</a>       def load_attributes_from_response(response)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1008">1008</a>         if response['Content-Length'] != &quot;0&quot; &amp;&amp; response.body.strip.size &gt; 0</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1009">1009</a>           load(self.class.format.decode(response.body))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1010">1010</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1011">1011</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1012">1012</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1013">1013</a>       # Takes a response from a typical create post and pulls the ID out</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1014">1014</a>       def id_from_response(response)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1015">1015</a>         response['Location'][/\/([^\/]*?)(\.\w+)?$/, 1] if response['Location']</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1016">1016</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1017">1017</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1018">1018</a>       def element_path(options = nil)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1019">1019</a>         self.class.element_path(to_param, options || prefix_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1020">1020</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1021">1021</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1022">1022</a>       def collection_path(options = nil)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1023">1023</a>         self.class.collection_path(options || prefix_options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1024">1024</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1025">1025</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1026">1026</a>     private</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1027">1027</a>       # Tries to find a resource for a given collection name; if it fails, then the resource is created</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1028">1028</a>       def find_or_create_resource_for_collection(name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1029">1029</a>         find_or_create_resource_for(name.to_s.singularize)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1030">1030</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1031">1031</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1032">1032</a>       # Tries to find a resource in a non empty list of nested modules</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1033">1033</a>       # Raises a NameError if it was not found in any of the given nested modules</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1034">1034</a>       def find_resource_in_modules(resource_name, module_names)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1035">1035</a>         receiver = Object</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1036">1036</a>         namespaces = module_names[0, module_names.size-1].map do |module_name|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1037">1037</a>           receiver = receiver.const_get(module_name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1038">1038</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1039">1039</a>         if namespace = namespaces.reverse.detect { |ns| ns.const_defined?(resource_name) }</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1040">1040</a>           return namespace.const_get(resource_name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1041">1041</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1042">1042</a>           raise NameError</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1043">1043</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1044">1044</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1045">1045</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1046">1046</a>       # Tries to find a resource for a given name; if it fails, then the resource is created</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1047">1047</a>       def find_or_create_resource_for(name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1048">1048</a>         resource_name = name.to_s.camelize</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1049">1049</a>         ancestors = self.class.name.split(&quot;::&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1050">1050</a>         if ancestors.size &gt; 1</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1051">1051</a>           find_resource_in_modules(resource_name, ancestors)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1052">1052</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1053">1053</a>           self.class.const_get(resource_name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1054">1054</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1055">1055</a>       rescue NameError</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1056">1056</a>         if self.class.const_defined?(resource_name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1057">1057</a>           resource = self.class.const_get(resource_name)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1058">1058</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1059">1059</a>           resource = self.class.const_set(resource_name, Class.new(ActiveResource::Base))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1060">1060</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1061">1061</a>         resource.prefix = self.class.prefix</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1062">1062</a>         resource.site   = self.class.site</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1063">1063</a>         resource</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1064">1064</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1065">1065</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1066">1066</a>       def split_options(options = {})</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1067">1067</a>         self.class.__send__(:split_options, options)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1068">1068</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1069">1069</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line1070">1070</a>       def method_missing(method_symbol, *arguments) #:nodoc:</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1071">1071</a>         method_name = method_symbol.to_s</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1072">1072</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1073">1073</a>         case method_name.last</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1074">1074</a>           when &quot;=&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1075">1075</a>             attributes[method_name.first(-1)] = arguments.first</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1076">1076</a>           when &quot;?&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1077">1077</a>             attributes[method_name.first(-1)]</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1078">1078</a>           else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1079">1079</a>             attributes.has_key?(method_name) ? attributes[method_name] : super</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1080">1080</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1081">1081</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1082">1082</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line1083">1083</a> end</pre></td>
          </tr>
        
      </tbody>
    </table>

    <p>Generated on Sat Oct 10 16:43:26 -0400 2009 with <a href="http://github.com/relevance/rcov">rcov 0.9.3</a></p>

  </body>
</html>
